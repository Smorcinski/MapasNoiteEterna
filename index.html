<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Nimor</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="map-container">
        <img src="nimor.png" alt="Mapa" id="map">
        <!-- Adicione os pontos de interesse (POIs) conforme necessário -->
    </div>
    <div id="tooltip" class="tooltip"></div>

    <div class="coordinates" id="coordinates"></div>

    <div class="download-button-container">
        <button onclick="downloadCoordenadas()">Baixar Coordenadas</button>
    </div>

    <script>
        // Verifica se há dados previamente armazenados no localStorage
        var coordenadas = JSON.parse(localStorage.getItem('coordenadas')) || [];
        var registro = 0;

        document.addEventListener('mousedown', function(event) {
            if (event.button === 0) { // Botão esquerdo do mouse
                var x = event.clientX;
                var y = event.clientY;
                var width = window.innerWidth;
                var height = document.querySelector('.map-container').clientHeight;
                var scrollTop = window.pageYOffset || document.documentElement.scrollTop; // Calcula o deslocamento vertical da página

                var xPercent = (x / width) * 100;
                var yPercent = ((y + scrollTop) / height) * 100; // Adiciona o deslocamento vertical da página

                coordenadas.push({ x: xPercent.toFixed(2), y: yPercent.toFixed(2) });
                registro++;

                // Cria a div POI com as coordenadas e número de registro
                var divPOI = document.createElement('div');
                divPOI.classList.add('poi');
                divPOI.dataset.info = 'Circulo Preto ' + registro;
                divPOI.style.top = yPercent.toFixed(2) + '%';
                divPOI.style.left = xPercent.toFixed(2) + '%';

                document.querySelector('.map-container').appendChild(divPOI);
            } else if (event.button === 2) { // Botão direito do mouse
                coordenadas.pop(); // Remove o último registro do array
                registro--;
                var divPOIs = document.querySelectorAll('.poi');
                if (divPOIs.length > 0) {
                    divPOIs[registro].remove(); // Remove o último div POI criado
                }
            }

            // Atualiza os dados armazenados no localStorage
            localStorage.setItem('coordenadas', JSON.stringify(coordenadas));
        });

        function downloadCoordenadas() {
            var textoCoordenadas = coordenadas.map(coordenada => `<div class="poi" data-info="Circulo Preto ${coordenada.x}" style="top: ${coordenada.y}%; left: ${coordenada.x}%;"></div>`).join('\n');

            var blob = new Blob([textoCoordenadas], { type: 'text/plain' });
            var url = window.URL.createObjectURL(blob);

            var a = document.createElement('a');
            a.href = url;
            a.download = 'coordenadas.txt';
            document.body.appendChild(a);
            a.click();

            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>


